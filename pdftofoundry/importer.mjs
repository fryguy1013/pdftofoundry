function _0x4fd3(){const _0x414045=['sentenceCase','@Actor[','3014140EDsaEU','substr','loading','folder','image/webp','\x20/\x20','emitImage','fontName','onload','adventure','token','weak','importActor','path','readUploadedFileAsText','noImport','drawImage','additionalMessages','elite','pages','includes','5aPBDDh','getOperatorList','fillRect','fadeOut','from','npc','textContent','abort','join','offSetY','textContinuation','objs','indexOf','createdFolders','beginGroup','.webp','sidebar','generate','sceneSort','readAsText','fill','parsePdf','ensureFolderExists','putImageData','strokeRGBColor','entries','ModuleImporter','\x20\x20\x20\x20','display','toString','journalPages','npcs','createDocuments','441wNQxAS','getFontDetails','tokens','system','toBlob','get','404874hwQLst','getDocument','\x20\x20\x20\x20beginGroup\x20-\x20','background','beginText','basePath','filter','currentTextMatrix','\x20\x20\x20\x20transform\x20-\x20','trim','fnArray','offsetY','setGState','eagerLoad','leading','finalize','setLineWidth','canonical','split','moveText','startsWith','fromCompendium','offsetX','map','argsArray','<br>Failed\x20importing\x20','_id','queue','JournalEntry','ensureId','commonObjs','getText','img','currentTextLineMatrix','getContext','getImageCanvas','dest','createImageData','#progress','set','width','createScene','lazyFolder','Extracting\x20page\x20','getTokenDocument','any','import','\x27..','flags','Sidebars','uploadTokenArt','120406mpONTM','reduce','push','create','setWordSpacing','error','emitFile','workerSrc','data','combines','decodeEncodedString','],\x20','Token','Extracting\x20scene\x20','fromUuid','pf2e','userId','stringify','notifications','getPage','Fetching\x20page\x20','toLocaleUpperCase','PDFToFoundry\x20|\x20creating\x20folder\x20\x27','Actor',')\x20\x22','restore','save','readUploadedFileAsBinary',':S}','parse',':U}','\x20\x20\x20\x20constructPath\x20-\x20','text','settings','abs','getTextById','28284UkXgeh','readAsArrayBuffer','fillRGBColor','has','name','637NhsZTP','\x20-\x20\x22','documentClass','replace','OPS','isSpace','getCanonicalArtForToken','thumb','textDetails','lineWidth','getElementById','unicode','find','1315902NmYqPH','fixupJournal','PDF\x20to\x20Foundry','end','pop','endText','assign','\x20\x20\x20\x20restore\x20-\x20','clamped','paintImageXObject','trimEnd','createThumbnail','\x20\x20\x20\x20setStrokeRGBColor\x20-\x20','result','clip','white','npcActors','priority','prefix','journalId','src','journalPageId','progressFn','moduleArt','\x20\x20\x20\x20?','fontMatrix','1371606aDfbDZ','pdftofoundry','onerror','fillStyle','prototypeToken','\x20\x20\x20\x20setFillRGBColor\x20-\x20','wordSpacing','getTokenArt','PDFToFoundry\x20|\x20emitting\x20file\x20to\x20[','start','charSpacing','hidden','transform','toLocaleLowerCase','670GGPaoi','querySelector','flatMap','update','slice','114488NUuWFZ','generateData','endGroup','kind','rotate','translate','baseFontSize','PDFToFoundry\x20|\x20..done','fullName','appendJournal','value','\x20\x20\x20\x20setLeadingMoveText\x20','PdfData','height','alwaysCreateScenes','actors','length','There\x20wasn\x27t\x20an\x20npc\x20to\x20import\x20for\x20','scenes','renderToCanvasFn','traits','actor',']\x20[','style','page','toObject','forIds','log','GlobalWorkerOptions','substring','Extracting\x20npc\x20','padStart','setFillRGBColor','Your\x20import\x20of\x20','Couldn\x27t\x20detect\x20watermark\x20:(.\x20Please\x20no\x20pirate.','contents','Problem\x20parsing\x20input\x20file.','\x20\x20\x20\x20setGState\x20-\x20','nextLine','defineProperty','image','\x20\x20\x20\x20save\x20-\x20','setFont','getCanonicalSceneMapping','content','unknown\x20kind\x20of\x20image\x20:(\x20:(\x20:(','setStrokeRGBColor','journalEntries','fontId','keys','round','gstate','showText','\x20-\x20','some'];_0x4fd3=function(){return _0x414045;};return _0x4fd3();}function _0x924f(_0xc4f73c,_0x139938){const _0x4fd310=_0x4fd3();return _0x924f=function(_0x924f7a,_0x3755ac){_0x924f7a=_0x924f7a-0x132;let _0x1fa568=_0x4fd310[_0x924f7a];return _0x1fa568;},_0x924f(_0xc4f73c,_0x139938);}const _0x1d3e13=_0x924f;(function(_0x5e34ff,_0x3fe783){const _0x3483f7=_0x924f,_0x6f5ca6=_0x5e34ff();while(!![]){try{const _0x314c0e=parseInt(_0x3483f7(0x1e1))/0x1+-parseInt(_0x3483f7(0x13f))/0x2+-parseInt(_0x3483f7(0x159))/0x3+-parseInt(_0x3483f7(0x1a5))/0x4*(-parseInt(_0x3483f7(0x1ba))/0x5)+-parseInt(_0x3483f7(0x238))/0x6*(-parseInt(_0x3483f7(0x132))/0x7)+-parseInt(_0x3483f7(0x16c))/0x8*(-parseInt(_0x3483f7(0x1db))/0x9)+-parseInt(_0x3483f7(0x167))/0xa*(parseInt(_0x3483f7(0x214))/0xb);if(_0x314c0e===_0x3fe783)break;else _0x6f5ca6['push'](_0x6f5ca6['shift']());}catch(_0x27a06f){_0x6f5ca6['push'](_0x6f5ca6['shift']());}}}(_0x4fd3,0x6b717));var __defProp=Object[_0x1d3e13(0x193)],__defNormalProp=(_0x4a1632,_0x1e2515,_0x13f9a)=>_0x1e2515 in _0x4a1632?__defProp(_0x4a1632,_0x1e2515,{'enumerable':!![],'configurable':!![],'writable':!![],'value':_0x13f9a}):_0x4a1632[_0x1e2515]=_0x13f9a,__name=(_0x4c9506,_0x2565f4)=>__defProp(_0x4c9506,_0x1d3e13(0x23c),{'value':_0x2565f4,'configurable':!![]}),__publicField=(_0x1c82db,_0x1c02e9,_0x3378c6)=>{return __defNormalProp(_0x1c82db,typeof _0x1c02e9!=='symbol'?_0x1c02e9+'':_0x1c02e9,_0x3378c6),_0x3378c6;};import{p as _0x26cbd0,c as _0x520123,l as _0x345d2e,j as _0x1ffe28,b as _0x37056b}from'./vendor.mjs';import{m as _0x26fe8f,s as _0x5c0deb,u as _0x50a368,g as _0xad8b2b,t as _0x54ef6b,M as _0x12a870,a as _0x7cba08}from'./FoundryGui.mjs';const style='',_PdfData=class _PdfData{constructor(_0x257290){const _0x27e2e3=_0x1d3e13;__publicField(this,'imageDetails'),__publicField(this,_0x27e2e3(0x13a)),Object[_0x27e2e3(0x145)](this,_0x257290);}['createEncodedStringFromText'](_0x4f8f34){const _0xaa978e=_0x1d3e13;let _0x56a750='',_0x5a4d00=_0x4f8f34;while(_0x5a4d00[_0xaa978e(0x17c)]>0x0){let _0x1b14e9=![];for(let _0xc0de6e=_0x5a4d00[_0xaa978e(0x17c)];_0xc0de6e>0x0;_0xc0de6e--){const _0x150e1b=_0x5a4d00[_0xaa978e(0x189)](0x0,_0xc0de6e);let _0x54a6fb=void 0x0;if(_0xc0de6e===0x1)_0x54a6fb=_0x150e1b;for(const _0x42a1a0 of this[_0xaa978e(0x13a)]){const _0x1315ae=_0x42a1a0[_0xaa978e(0x234)][_0xaa978e(0x166)]()[_0xaa978e(0x1c6)](_0x150e1b[_0xaa978e(0x166)]());if(_0x1315ae!==-0x1){const _0x33b255=_0x42a1a0[_0xaa978e(0x234)][_0xaa978e(0x189)](_0x1315ae,_0x1315ae+_0xc0de6e);let _0xf6d822=void 0x0;if(_0x33b255===_0x150e1b)_0xf6d822='{'+_0x42a1a0['id']+':'+_0x1315ae+':'+(_0x1315ae+_0xc0de6e)+'}';else{if(this[_0xaa978e(0x1a3)](_0x33b255)===_0x150e1b)_0xf6d822='{'+_0x42a1a0['id']+':'+_0x1315ae+':'+(_0x1315ae+_0xc0de6e)+_0xaa978e(0x230);else{if(_0x33b255[_0xaa978e(0x229)]()===_0x150e1b)_0xf6d822='{'+_0x42a1a0['id']+':'+_0x1315ae+':'+(_0x1315ae+_0xc0de6e)+_0xaa978e(0x232);else{if(_0x33b255[_0xaa978e(0x166)]()===_0x150e1b)_0xf6d822='{'+_0x42a1a0['id']+':'+_0x1315ae+':'+(_0x1315ae+_0xc0de6e)+':L}';else{const _0x3ee25c=[...Array(_0x150e1b[_0xaa978e(0x17c)])[_0xaa978e(0x19d)]()]['filter'](_0x2941bd=>_0x150e1b[_0x2941bd]===_0x150e1b[_0x2941bd][_0xaa978e(0x229)]());_0xf6d822='{'+_0x42a1a0['id']+':'+_0x1315ae+':'+(_0x1315ae+_0xc0de6e)+':'+_0x3ee25c[_0xaa978e(0x1c2)](',')+'}';}}}}if(_0x54a6fb===void 0x0||_0xf6d822['length']<_0x54a6fb[_0xaa978e(0x17c)])_0x54a6fb=_0xf6d822;}}if(_0x54a6fb){_0x56a750+=_0x54a6fb,_0x5a4d00=_0x5a4d00[_0xaa978e(0x189)](_0xc0de6e),_0x1b14e9=!![];break;}}if(!_0x1b14e9)break;}return _0x56a750;}[_0x1d3e13(0x21e)](_0x3f19d5){return _0x3f19d5['replace'](/\{([^}]*):([^}]*):([^}]*)(:([^}]*))?\}/g,_0x24010b=>{const _0x43c487=_0x924f,_0x5b5f78=_0x24010b['substring'](0x1,_0x24010b[_0x43c487(0x17c)]-0x1)[_0x43c487(0x1f3)](':'),_0x159432=this['textDetails'][_0x43c487(0x13e)](_0x1b480b=>_0x1b480b['id']===_0x5b5f78[0x0]);if(!_0x159432)return'';let _0xbf3545=_0x159432[_0x43c487(0x234)]['substring'](Number(_0x5b5f78[0x1]),Number(_0x5b5f78[0x2]));if(_0x5b5f78['length']>=0x4&&_0x5b5f78[0x3]==='L')_0xbf3545=_0xbf3545[_0x43c487(0x166)]();else{if(_0x5b5f78[_0x43c487(0x17c)]>=0x4&&_0x5b5f78[0x3]==='U')_0xbf3545=_0xbf3545[_0x43c487(0x229)]();else{if(_0x5b5f78['length']>=0x4&&_0x5b5f78[0x3]==='S')_0xbf3545=this[_0x43c487(0x1a3)](_0xbf3545);else{if(_0x5b5f78[_0x43c487(0x17c)]>=0x4){const _0x3eca47=_0x5b5f78[0x3]['split'](',');_0xbf3545=[...Array(_0xbf3545['length'])[_0x43c487(0x19d)]()][_0x43c487(0x1f8)](_0x2a365d=>_0x3eca47[_0x43c487(0x13e)](_0x5266c9=>_0x5266c9===''+_0x2a365d)?_0xbf3545[_0x2a365d]['toLocaleUpperCase']():_0xbf3545[_0x2a365d])[_0x43c487(0x1c2)]('');}}}}return _0xbf3545;});}['sentenceCase'](_0x1cdd81){const _0x50d6da=_0x1d3e13;return _0x1cdd81[_0x50d6da(0x1f3)]('\x20')[_0x50d6da(0x1f8)](_0x13ffbc=>_0x13ffbc[_0x50d6da(0x17c)]>0x1?_0x13ffbc[0x0]['toUpperCase']()+_0x13ffbc[_0x50d6da(0x1a6)](0x1)['toLowerCase']():_0x13ffbc)['join']('\x20')[_0x50d6da(0x1ea)]();}[_0x1d3e13(0x200)](_0x394697){const _0xfe5489=_0x1d3e13,_0x58b7f3=this[_0xfe5489(0x13a)]['find'](_0x12b1f5=>_0x12b1f5[_0xfe5489(0x184)]===_0x394697[_0xfe5489(0x184)]&&Math[_0xfe5489(0x236)](_0x12b1f5['x']-_0x394697['x'])<0x1&&Math['abs'](_0x12b1f5['y']-_0x394697['y'])<0x1);if(!_0x58b7f3)return'';let _0x3cd1f3=_0x58b7f3['text'];return _0x394697[_0xfe5489(0x189)]!==void 0x0&&(_0x3cd1f3=_0x3cd1f3[_0xfe5489(0x189)](_0x394697[_0xfe5489(0x189)][_0xfe5489(0x162)],_0x394697['substring'][_0xfe5489(0x142)])),(_0x394697[_0xfe5489(0x1a3)]===void 0x0||_0x394697[_0xfe5489(0x1a3)]===!![])&&(_0x3cd1f3=this[_0xfe5489(0x1a3)](_0x3cd1f3)),_0x3cd1f3;}[_0x1d3e13(0x237)](_0x8fef88){const _0x4708e0=_0x1d3e13,_0x366ca2=this['textDetails'][_0x4708e0(0x13e)](_0x2a25f0=>_0x2a25f0['id']===_0x8fef88);if(!_0x366ca2)return'';return _0x366ca2[_0x4708e0(0x234)];}};__name(_PdfData,_0x1d3e13(0x178));let PdfData=_PdfData;function log(_0xa55814){}__name(log,'log');async function parsePdf(_0x1a25c2,_0x50ba2c,_0x117862){const _0x9f8e70=_0x1d3e13,_0x584d57=_0x26cbd0[_0x9f8e70(0x1e2)](_0x1a25c2),_0x3c72a7=await _0x584d57['promise'],_0x372e2f=[],_0x5e4455=[],_0x4da068=new Set();let _0x212b75=0x1;const _0x3535df=_0x117862===void 0x0||_0x117862[_0x9f8e70(0x17c)]===0x0?Array(_0x3c72a7['numPages'])[_0x9f8e70(0x1ce)](0x1)[_0x9f8e70(0x1f8)]((_0x29ca28,_0x54cd50)=>_0x29ca28+_0x54cd50):_0x117862;for(let _0x1227d2=0x0;_0x1227d2<_0x3535df[_0x9f8e70(0x17c)];_0x1227d2++){const _0x4eeee5=_0x3535df[_0x1227d2];_0x50ba2c(_0x9f8e70(0x228)+_0x4eeee5,_0x1227d2/_0x3535df[_0x9f8e70(0x17c)]);const _0x4ffad9=await _0x3c72a7[_0x9f8e70(0x227)](_0x4eeee5),_0x208cab=await _0x4ffad9[_0x9f8e70(0x1bb)]({'intent':_0x9f8e70(0x20e)}),_0x37402d=_0x212b75;let _0x12ac6b=![];const _0x37e67a=[],_0x4fdf12=__name(_0x309154=>{const _0x383452=_0x9f8e70;let _0x11a94e=_0x309154,_0x486fc6=[0x1,0x0,0x0,0x1,0x0,0x0];try{const _0x57a534=_0x4ffad9[_0x383452(0x1ff)]['get'](_0x309154);_0x11a94e=_0x57a534[_0x383452(0x23c)];if(_0x57a534[_0x383452(0x158)])_0x486fc6=_0x57a534['fontMatrix'];}catch{}const _0xee3bf=_0x309154[_0x383452(0x1c6)]('+');if(_0xee3bf!==-0x1)_0x11a94e=_0x309154['substring'](_0xee3bf+0x1);return[_0x11a94e,_0x486fc6];},_0x9f8e70(0x1dc)),_0x1a4f78=Object[_0x9f8e70(0x1d3)](_0x26cbd0[_0x9f8e70(0x136)])[_0x9f8e70(0x215)]((_0x16f0ed,_0x5352e9)=>{const [_0x59d381,_0xe9d47d]=_0x5352e9;return _0x16f0ed[_0xe9d47d]=_0x59d381,_0x16f0ed;},{}),_0x5c7431={'fontName':'','baseFontSize':0x1,'currentTextMatrix':[0x1,0x0,0x0,0x1,0x0,0x0],'currentTextLineMatrix':[0x1,0x0,0x0,0x1,0x0,0x0],'fillRGBColor':'','strokeRGBColor':'','lineWidth':0x0,'leading':0x0,'charSpacing':0x0,'wordSpacing':0x0,'gstate':{},'transform':[0x1,0x0,0x0,0x1,0x0,0x0],'path':[],'clip':[],'fontMatrix':[0x1,0x0,0x0,0x1,0x0,0x0],'textContinuation':![]},_0x2f84b3=[];let _0x189f2e=_0x5c7431;const _0x5ff414=__name((_0x3b9df7,_0x2b3c6f)=>{const _0x20a463=_0x9f8e70;_0x189f2e['currentTextLineMatrix'][0x4]+=_0x3b9df7*_0x189f2e[_0x20a463(0x202)][0x0],_0x189f2e[_0x20a463(0x202)][0x5]+=_0x2b3c6f*_0x189f2e[_0x20a463(0x202)][0x3],_0x189f2e[_0x20a463(0x1e8)]=[..._0x189f2e[_0x20a463(0x202)]],_0x189f2e[_0x20a463(0x1c4)]=![];},_0x9f8e70(0x1f4));for(let _0xd6a0c8=0x0;_0xd6a0c8<_0x208cab['fnArray'][_0x9f8e70(0x17c)];_0xd6a0c8++){const _0x2c439c=_0x208cab[_0x9f8e70(0x1f9)][_0xd6a0c8],_0x476bbd=_0x1a4f78[_0x208cab[_0x9f8e70(0x1eb)][_0xd6a0c8]];switch(_0x208cab['fnArray'][_0xd6a0c8]){case _0x26cbd0['OPS']['setTextMatrix']:log('\x20\x20\x20\x20setTextMatrix\x20'+JSON[_0x9f8e70(0x225)](_0x2c439c)),_0x189f2e[_0x9f8e70(0x202)]=_0x2c439c,_0x189f2e[_0x9f8e70(0x1e8)]=[..._0x189f2e['currentTextLineMatrix']];break;case _0x26cbd0[_0x9f8e70(0x136)][_0x9f8e70(0x196)]:[_0x189f2e[_0x9f8e70(0x1ac)],_0x189f2e[_0x9f8e70(0x172)]]=_0x2c439c,[_0x189f2e[_0x9f8e70(0x1ac)],_0x189f2e[_0x9f8e70(0x158)]]=_0x4fdf12(_0x189f2e['fontName']),_0x189f2e[_0x9f8e70(0x1ac)]=_0x189f2e[_0x9f8e70(0x1ac)][_0x9f8e70(0x135)](/[^+]+\+/,'');break;case _0x26cbd0[_0x9f8e70(0x136)][_0x9f8e70(0x1a0)]:{const _0x2376b4=_0x2c439c[0x0][_0x9f8e70(0x1f8)](_0x421345=>_0x421345[_0x9f8e70(0x13d)])[_0x9f8e70(0x1c2)](''),_0x502fb6=_0x2c439c[0x0][_0x9f8e70(0x1f8)](_0x116bf2=>_0x116bf2['width']??0x0)[_0x9f8e70(0x215)]((_0x3e3252,_0x54a64d)=>_0x3e3252+_0x54a64d,0x0),_0x4f4619=_0x2c439c[0x0][_0x9f8e70(0x1f8)](_0x2b264a=>_0x2b264a[_0x9f8e70(0x137)]??0x0)[_0x9f8e70(0x215)]((_0x384f7b,_0x10642c)=>_0x384f7b+_0x10642c,0x0),_0x5e8b54=_0x189f2e['currentTextMatrix'][0x2],_0xe86a00=_0x189f2e[_0x9f8e70(0x1e8)][0x3],_0x48abe5=Math['sqrt'](_0x5e8b54*_0x5e8b54+_0xe86a00*_0xe86a00),_0x2535ad=_0x189f2e[_0x9f8e70(0x172)]*_0x48abe5,_0x371624=_0x189f2e[_0x9f8e70(0x1ac)]+':'+_0x2535ad,_0x11911f=_0x189f2e[_0x9f8e70(0x1e8)][0x4],_0xbac746=_0x189f2e[_0x9f8e70(0x1e8)][0x5];log('(['+_0x11911f+',\x20'+_0xbac746+_0x9f8e70(0x21f)+_0x189f2e['fontName']+':'+_0x2535ad+_0x9f8e70(0x1a1)+_0x189f2e['fillRGBColor']+'/'+_0x189f2e['strokeRGBColor']+'/'+_0x189f2e[_0x9f8e70(0x13b)]+'\x20['+_0x189f2e['charSpacing']+_0x9f8e70(0x1aa)+_0x189f2e[_0x9f8e70(0x15f)]+'])\x20'+_0x502fb6+'/'+_0x4f4619+_0x9f8e70(0x133)+_0x2376b4+'\x22');const _0x15b3c3=ensureId(_0x4da068,_0xb6f865=>_0x37402d+':'+Math[_0x9f8e70(0x19e)](_0x11911f)+':'+Math[_0x9f8e70(0x19e)](_0xbac746)+(_0xb6f865>0x0?':'+_0xb6f865:''));if(_0xbac746===0x2)_0x12ac6b=!![];const _0x2a76c3=_0x372e2f[_0x9f8e70(0x17c)]>0x0&&_0x372e2f[_0x372e2f[_0x9f8e70(0x17c)]-0x1]['text']===_0x2376b4;if(!_0x2a76c3&&_0x2535ad>0x4){if(_0x189f2e[_0x9f8e70(0x1c4)]&&_0x2376b4[_0x9f8e70(0x1ea)]()===''&&_0x371624===_0x372e2f[_0x372e2f['length']-0x1][_0x9f8e70(0x19c)])_0x372e2f[_0x372e2f[_0x9f8e70(0x17c)]-0x1][_0x9f8e70(0x234)]=_0x372e2f[_0x372e2f['length']-0x1][_0x9f8e70(0x234)][_0x9f8e70(0x149)]()+_0x2376b4;else _0x2376b4[_0x9f8e70(0x1ea)]()!==''&&_0x372e2f['push']({'text':_0x2376b4,'fontId':_0x371624,'fontName':_0x189f2e['fontName'],'fontSize':_0x2535ad,'color':_0x189f2e[_0x9f8e70(0x23a)],'isLeftAligned':![],'isIndented':![],'page':_0x37402d,'x':_0x11911f,'y':_0xbac746,'id':btoa(_0x15b3c3)[_0x9f8e70(0x135)](/=/g,'')});}_0x189f2e['currentTextMatrix'][0x4]+=(_0x502fb6*_0x189f2e[_0x9f8e70(0x158)][0x0]+_0x2376b4[_0x9f8e70(0x17c)]*_0x189f2e[_0x9f8e70(0x163)]+_0x4f4619*_0x189f2e[_0x9f8e70(0x15f)])*_0x189f2e['currentTextMatrix'][0x0],_0x189f2e[_0x9f8e70(0x1c4)]=!![];break;}case _0x26cbd0['OPS'][_0x9f8e70(0x1e5)]:break;case _0x26cbd0['OPS'][_0x9f8e70(0x144)]:break;case _0x26cbd0[_0x9f8e70(0x136)][_0x9f8e70(0x1f4)]:_0x5ff414(_0x2c439c[0x0],_0x2c439c[0x1]);break;case _0x26cbd0[_0x9f8e70(0x136)]['setCharSpacing']:_0x189f2e['charSpacing']=_0x2c439c[0x0];break;case _0x26cbd0['OPS'][_0x9f8e70(0x218)]:_0x189f2e[_0x9f8e70(0x15f)]=_0x2c439c[0x0];break;case _0x26cbd0[_0x9f8e70(0x136)]['setLeadingMoveText']:log(_0x9f8e70(0x177)+JSON[_0x9f8e70(0x225)](_0x2c439c)),_0x189f2e[_0x9f8e70(0x1ef)]=-_0x2c439c[0x1],_0x5ff414(_0x2c439c[0x0],_0x2c439c[0x1]);break;case _0x26cbd0['OPS'][_0x9f8e70(0x192)]:_0x5ff414(0x0,-_0x189f2e['leading']);break;case _0x26cbd0[_0x9f8e70(0x136)][_0x9f8e70(0x22e)]:log(_0x9f8e70(0x195)+JSON['stringify'](_0x189f2e)),_0x2f84b3['push'](JSON[_0x9f8e70(0x231)](JSON[_0x9f8e70(0x225)](_0x189f2e)));break;case _0x26cbd0['OPS'][_0x9f8e70(0x22d)]:_0x189f2e=_0x2f84b3[_0x9f8e70(0x143)](),log(_0x9f8e70(0x146)+JSON[_0x9f8e70(0x225)](_0x189f2e));break;case _0x26cbd0['OPS']['paintJpegXObject']:case _0x26cbd0[_0x9f8e70(0x136)][_0x9f8e70(0x148)]:log(_0x9f8e70(0x1d5)+_0x476bbd+_0x9f8e70(0x1a1)+JSON['stringify'](_0x2c439c)),_0x37e67a[_0x9f8e70(0x216)]({'image':_0x2c439c[0x0],'gstate':_0x189f2e[_0x9f8e70(0x19f)],'transform':_0x189f2e[_0x9f8e70(0x165)],'clip':_0x189f2e['clip']});break;case _0x26cbd0['OPS'][_0x9f8e70(0x18c)]:_0x189f2e['fillRGBColor']='#'+Array[_0x9f8e70(0x1be)](_0x2c439c)[_0x9f8e70(0x1f8)](_0x595b35=>_0x595b35['toString'](0x10)[_0x9f8e70(0x18b)](0x2,'0'))['join'](''),log(_0x9f8e70(0x15e)+JSON[_0x9f8e70(0x225)](_0x2c439c));break;case _0x26cbd0[_0x9f8e70(0x136)][_0x9f8e70(0x19a)]:_0x189f2e[_0x9f8e70(0x1d2)]='#'+Array[_0x9f8e70(0x1be)](_0x2c439c)[_0x9f8e70(0x1f8)](_0x3ed88f=>_0x3ed88f[_0x9f8e70(0x1d7)](0x10)['padStart'](0x2,'0'))[_0x9f8e70(0x1c2)](''),log(_0x9f8e70(0x14b)+JSON[_0x9f8e70(0x225)](_0x2c439c));break;case _0x26cbd0[_0x9f8e70(0x136)][_0x9f8e70(0x1f1)]:_0x189f2e[_0x9f8e70(0x13b)]=_0x2c439c[0x0];break;case _0x26cbd0[_0x9f8e70(0x136)][_0x9f8e70(0x1ed)]:log(_0x9f8e70(0x191)+JSON[_0x9f8e70(0x225)](_0x189f2e[_0x9f8e70(0x19f)]));break;case _0x26cbd0[_0x9f8e70(0x136)][_0x9f8e70(0x1c8)]:log(_0x9f8e70(0x1e3)+JSON[_0x9f8e70(0x225)](_0x2c439c[0x0])),_0x189f2e[_0x9f8e70(0x19f)]=_0x2c439c[0x0];break;case _0x26cbd0[_0x9f8e70(0x136)][_0x9f8e70(0x16e)]:log('\x20\x20\x20\x20endGroup\x20-\x20'+JSON[_0x9f8e70(0x225)](_0x2c439c[0x0])),_0x189f2e[_0x9f8e70(0x19f)]={};break;case _0x26cbd0[_0x9f8e70(0x136)][_0x9f8e70(0x165)]:log(_0x9f8e70(0x1e9)+JSON[_0x9f8e70(0x225)](_0x2c439c)),_0x189f2e[_0x9f8e70(0x165)]=_0x2c439c;break;case _0x26cbd0[_0x9f8e70(0x136)]['constructPath']:log(_0x9f8e70(0x233)+JSON[_0x9f8e70(0x225)](_0x2c439c)),_0x189f2e[_0x9f8e70(0x1b2)]=_0x2c439c;break;case _0x26cbd0[_0x9f8e70(0x136)][_0x9f8e70(0x14d)]:_0x189f2e[_0x9f8e70(0x14d)][_0x9f8e70(0x216)](_0x189f2e[_0x9f8e70(0x1b2)]);break;default:log(_0x9f8e70(0x157)+_0x476bbd+_0x9f8e70(0x1a1)+JSON[_0x9f8e70(0x225)](_0x2c439c));break;}}if(_0x12ac6b||_0x37402d+0x3<0xb)_0x212b75+=0x1;for(const _0x546d59 of _0x37e67a){const _0x8f9aa=_0x546d59[_0x9f8e70(0x194)],_0xcbcd61=_0x8f9aa['startsWith']('g_')?_0x4ffad9[_0x9f8e70(0x1ff)]:_0x4ffad9[_0x9f8e70(0x1c5)],_0x34da1c=new Promise(_0x136add=>_0xcbcd61[_0x9f8e70(0x1e0)](_0x8f9aa,_0xadd1d2=>_0x136add(_0xadd1d2))),_0x266009=await _0x34da1c;let _0x4c6f9d=__name(async _0x39e5ef=>{},'renderToCanvasFn');if(_0x266009[_0x9f8e70(0x153)]!==void 0x0)_0x4c6f9d=__name(async _0x1d1121=>{const _0x403d32=_0x9f8e70,_0x2a6df9=await _0x345d2e(_0x266009[_0x403d32(0x153)]);_0x1d1121[_0x403d32(0x1b5)](_0x2a6df9,0x0,0x0,_0x266009[_0x403d32(0x209)],_0x266009[_0x403d32(0x179)]);},_0x9f8e70(0x17f));else{if(_0x266009[_0x9f8e70(0x16f)]===0x3)_0x4c6f9d=__name(async _0x3ff3ca=>{const _0x1e60b6=_0x9f8e70,_0x1344e7=_0x3ff3ca[_0x1e60b6(0x206)](_0x266009[_0x1e60b6(0x209)],_0x266009[_0x1e60b6(0x179)]),_0x53f3a2=_0x1344e7['data'];_0x53f3a2[_0x1e60b6(0x208)](_0x266009[_0x1e60b6(0x21c)],0x0),_0x3ff3ca['putImageData'](_0x1344e7,0x0,0x0);},'renderToCanvasFn');else _0x266009[_0x9f8e70(0x16f)]===0x2?_0x4c6f9d=__name(async _0x57d208=>{const _0x461deb=_0x9f8e70,_0x4f5203=_0x57d208['createImageData'](_0x266009['width'],_0x266009[_0x461deb(0x179)]),_0x3aa935=_0x4f5203[_0x461deb(0x21c)];for(let _0x235625=0x0,_0x3420c8=0x0;_0x235625<_0x266009[_0x461deb(0x21c)][_0x461deb(0x17c)];_0x235625+=0x3,_0x3420c8+=0x4){_0x3aa935[_0x3420c8]=_0x266009['data'][_0x235625],_0x3aa935[_0x3420c8+0x1]=_0x266009['data'][_0x235625+0x1],_0x3aa935[_0x3420c8+0x2]=_0x266009['data'][_0x235625+0x2],_0x3aa935[_0x3420c8+0x3]=0xff;}_0x57d208[_0x461deb(0x1d1)](_0x4f5203,0x0,0x0);},_0x9f8e70(0x17f)):console[_0x9f8e70(0x219)](_0x9f8e70(0x199));}const _0x3ae562=__name(async(_0x4e6ddc,_0x4a843b,_0x3ddcb4,_0x23327b,_0x356466,_0x18a9ae,_0x44bad2)=>{const _0x28f07e=_0x9f8e70;let _0x18ddb1=_0x520123(_0x266009[_0x28f07e(0x209)],_0x266009[_0x28f07e(0x179)]);const _0x3c8324=_0x18ddb1['getContext']('2d');await _0x4c6f9d(_0x3c8324);if(_0x3ddcb4!==void 0x0&&_0x23327b!==void 0x0&&_0x356466!==void 0x0&&_0x18a9ae!==void 0x0){const _0x33bdc6=_0x356466-_0x3ddcb4,_0x2700ce=_0x18a9ae-_0x23327b,_0x53f4e2=_0x520123(_0x33bdc6,_0x2700ce),_0x145678=_0x53f4e2[_0x28f07e(0x203)]('2d');_0x145678['fillStyle']=_0x28f07e(0x14e),_0x145678['fillRect'](0x0,0x0,_0x53f4e2[_0x28f07e(0x209)],_0x53f4e2[_0x28f07e(0x179)]),_0x145678['drawImage'](_0x18ddb1,_0x3ddcb4,_0x23327b,_0x33bdc6,_0x2700ce,0x0,0x0,_0x33bdc6,_0x2700ce),_0x18ddb1=_0x53f4e2;}if(_0x44bad2!==void 0x0&&_0x44bad2!==0x0){let _0x111f88=_0x18ddb1[_0x28f07e(0x209)],_0x3c8093=_0x18ddb1['height'];_0x44bad2%0x2!==0x0&&([_0x111f88,_0x3c8093]=[_0x3c8093,_0x111f88]);const _0xb5066e=_0x520123(_0x111f88,_0x3c8093),_0x3f5326=_0xb5066e['getContext']('2d');_0x3f5326[_0x28f07e(0x15c)]='white',_0x3f5326[_0x28f07e(0x1bc)](0x0,0x0,_0xb5066e['width'],_0xb5066e[_0x28f07e(0x179)]),_0x3f5326['save'](),_0x3f5326[_0x28f07e(0x171)](_0x111f88/0x2,_0x3c8093/0x2),_0x3f5326[_0x28f07e(0x170)](_0x44bad2*Math['PI']/0x2),_0x3f5326[_0x28f07e(0x1b5)](_0x18ddb1,-_0x18ddb1[_0x28f07e(0x209)]/0x2,-_0x18ddb1[_0x28f07e(0x179)]/0x2),_0x3f5326[_0x28f07e(0x22d)](),_0x18ddb1=_0xb5066e;}if(_0x4e6ddc!==void 0x0&&_0x4a843b!==void 0x0&&_0x4e6ddc!==_0x266009[_0x28f07e(0x209)]&&_0x4a843b!==_0x266009[_0x28f07e(0x179)]){const _0x1b8a7a=_0x520123(_0x4e6ddc,_0x4a843b),_0x15b8c1=_0x1b8a7a['getContext']('2d');_0x15b8c1[_0x28f07e(0x15c)]=_0x28f07e(0x14e),_0x15b8c1[_0x28f07e(0x1bc)](0x0,0x0,_0x1b8a7a[_0x28f07e(0x209)],_0x1b8a7a[_0x28f07e(0x179)]),_0x15b8c1['drawImage'](_0x18ddb1,0x0,0x0,_0x1b8a7a['width'],_0x1b8a7a[_0x28f07e(0x179)]),_0x18ddb1=_0x1b8a7a;}return _0x18ddb1;},_0x9f8e70(0x204)),_0x55589b=ensureId(_0x4da068,_0x4e2fa0=>_0x37402d+':'+JSON[_0x9f8e70(0x225)](_0x546d59[_0x9f8e70(0x165)])+(_0x4e2fa0>0x0?':'+_0x4e2fa0:''));_0x5e4455[_0x9f8e70(0x216)]({'id':btoa(_0x55589b)[_0x9f8e70(0x135)](/=/g,''),'page':_0x37402d,'width':_0x266009['width'],'height':_0x266009[_0x9f8e70(0x179)],'transform':_0x546d59['transform'],'gstate':_0x546d59[_0x9f8e70(0x19f)],'clip':_0x546d59[_0x9f8e70(0x14d)],'getImageCanvas':_0x3ae562});}}{for(const _0x41e856 of _0x372e2f){log(_0x41e856[_0x9f8e70(0x19c)]+'\x20('+_0x41e856['x']+',\x20'+_0x41e856['y']+_0x9f8e70(0x22c)+_0x41e856[_0x9f8e70(0x234)]+'\x22');}}return new PdfData({'textDetails':_0x372e2f,'imageDetails':_0x5e4455});}__name(parsePdf,_0x1d3e13(0x1cf));function ensureId(_0x27f68f,_0x4f270e){const _0xc90c7f=_0x1d3e13;let _0x2b7f2b=0x0,_0x5255b6;while(!![]){_0x5255b6=_0x4f270e(_0x2b7f2b);if(!_0x27f68f[_0xc90c7f(0x23b)](_0x5255b6))break;_0x2b7f2b+=0x1;}return _0x27f68f['add'](_0x5255b6),_0x5255b6;}__name(ensureId,_0x1d3e13(0x1fe));const _ModuleImporter=class _ModuleImporter{constructor(_0x2f80e2){const _0x206ee3=_0x1d3e13;__publicField(this,_0x206ee3(0x1b6),''),__publicField(this,_0x206ee3(0x1cc),0x0),__publicField(this,'adventure'),__publicField(this,_0x206ee3(0x14f),new Map()),__publicField(this,_0x206ee3(0x1c7),[]),this[_0x206ee3(0x1ae)]=_0x2f80e2;}async[_0x1d3e13(0x222)](_0x4f8751){const _0x546ede=_0x1d3e13,_0x1a115a=await fromUuid(_0x4f8751);if(!_0x1a115a)return null;return game[_0x546ede(0x17b)][_0x546ede(0x1f6)](_0x1a115a);}async['ensureFolderExists'](_0x2fe508){const _0x2bff70=_0x1d3e13;if(this[_0x2bff70(0x1c7)][_0x2bff70(0x1b9)](_0x2fe508))return;const _0x3882d4=_0x2fe508[_0x2bff70(0x1f3)]('/');_0x3882d4[_0x2bff70(0x17c)]>0x1&&await this[_0x2bff70(0x1d0)](_0x3882d4[_0x2bff70(0x16b)](0x0,_0x3882d4[_0x2bff70(0x17c)]-0x1)[_0x2bff70(0x1c2)]('/'));try{console['log'](_0x2bff70(0x22a)+_0x2fe508+_0x2bff70(0x210)),await _0x26fe8f(_0x2fe508);}catch{}await _0x5c0deb(0x1f4),console[_0x2bff70(0x187)](_0x2bff70(0x173)),this[_0x2bff70(0x1c7)]['push'](_0x2fe508);}async[_0x1d3e13(0x21a)](_0x3680ed,_0x48b7d5,_0x1f1dca){const _0x428c4a=_0x1d3e13;console[_0x428c4a(0x187)](_0x428c4a(0x161)+this['adventure'][_0x428c4a(0x151)]+_0x428c4a(0x182)+_0x3680ed+_0x428c4a(0x182)+_0x48b7d5+']');const _0x4a9cb5=game['settings'][_0x428c4a(0x1e0)](_0x428c4a(0x15a),_0x428c4a(0x1e6)),_0x4f34e6=_0x1ffe28(_0x4a9cb5,this[_0x428c4a(0x1ae)][_0x428c4a(0x151)],_0x3680ed);return await this[_0x428c4a(0x1d0)](_0x4f34e6),await _0x50a368(_0x1f1dca,_0x4f34e6,_0x48b7d5),_0x1ffe28(_0x4f34e6,_0x48b7d5);}async[_0x1d3e13(0x1ab)](_0x128c1f,_0x131b3d,_0x455a80){const _0x56136a=_0x1d3e13;if(_0x455a80[_0x56136a(0x1df)]===void 0x0)return;const _0x3cccef=await new Promise(_0x25516f=>_0x455a80[_0x56136a(0x1df)](_0x2c58cd=>_0x25516f(_0x2c58cd),_0x56136a(0x1a9)));return await this['emitFile'](_0x128c1f,_0x131b3d,_0x3cccef);}[_0x1d3e13(0x138)](_0x4729d0){const _0x2bb03c=_0x1d3e13,_0x625465=_0xad8b2b()[_0x2bb03c(0x1e7)](_0x58ef3a=>_0x58ef3a[_0x2bb03c(0x151)]!==this['adventure'][_0x2bb03c(0x151)])[_0x2bb03c(0x169)](_0x1fab78=>_0x1fab78[_0x2bb03c(0x1d9)]['filter'](_0x517c3b=>_0x4729d0['shouldBeReplacedByArt'](_0x517c3b))[_0x2bb03c(0x1f8)](_0x280160=>_0x54ef6b[_0x2bb03c(0x160)](_0x1fab78,_0x280160))[_0x2bb03c(0x1e7)](_0x3a32fb=>_0x3a32fb!==void 0x0));return _0x625465==null?void 0x0:_0x625465[0x0];}async['finalize'](){const _0x2827af=_0x1d3e13;_0x54ef6b[_0x2827af(0x213)](),ui[_0x2827af(0x226)][_0x2827af(0x1fc)]=[];}[_0x1d3e13(0x140)](_0x3e7b57,_0x1fb0e9){const _0x3b9434=_0x1d3e13;_0x3e7b57['text'][_0x3b9434(0x198)]=_0x3e7b57['text'][_0x3b9434(0x198)]['replace'](/<h4 data-monster-id="(.*?)">([^<>]+)<\/h4>/g,(_0x29aa20,_0xcc43af,_0x3fd4b5)=>{const _0x44dd64=_0x3b9434;if(_0x1fb0e9['has'](_0xcc43af))return _0x44dd64(0x1a4)+_0x1fb0e9['get'](_0xcc43af)+']{'+_0x3fd4b5+'}';return console[_0x44dd64(0x187)]('Can\x27t\x20find\x20actor\x20'+_0xcc43af),_0x29aa20;});}[_0x1d3e13(0x197)](){const _0x58baa8=_0x1d3e13,_0x21bbd9=game[_0x58baa8(0x235)][_0x58baa8(0x1e0)](_0x58baa8(0x15a),_0x58baa8(0x1e6)),_0x14a08f=_0xad8b2b()[_0x58baa8(0x169)](_0x52de60=>_0x52de60[_0x58baa8(0x17e)][_0x58baa8(0x1f8)](_0x4a36f3=>{const _0x19e965=_0x58baa8;var _0x6c6961,_0xa4dd64;return{'path':_0x1ffe28(_0x21bbd9,_0x52de60[_0x19e965(0x151)],_0x4a36f3[_0x19e965(0x23c)]+_0x19e965(0x1c9)),'name':(_0x6c6961=_0x4a36f3[_0x19e965(0x1f2)])==null?void 0x0:_0x6c6961['name'],'priority':(_0xa4dd64=_0x4a36f3['canonical'])==null?void 0x0:_0xa4dd64['priority']};}));return _0x14a08f;}async[_0x1d3e13(0x20a)](_0x31bdba,_0x56e44e,_0x20f0af,_0x258240){const _0x56adad=_0x1d3e13;if(_0x56e44e){const _0x15259b=this[_0x56adad(0x197)]();for(const _0x134bd4 of game[_0x56adad(0x17e)]['contents']){const _0x1100a2=_0x15259b[_0x56adad(0x1e7)](_0x28a2e0=>_0x28a2e0['name']===_0x56e44e)[_0x56adad(0x13e)](_0x54ba55=>_0x54ba55['path']===_0x134bd4[_0x56adad(0x1e4)][_0x56adad(0x153)]);if(_0x1100a2&&_0x20f0af>_0x1100a2[_0x56adad(0x150)]){await _0x134bd4[_0x56adad(0x16a)]({'img':_0x31bdba[_0x56adad(0x201)],'width':_0x31bdba[_0x56adad(0x209)],'height':_0x31bdba[_0x56adad(0x179)],'background.offsetX':_0x31bdba['background'][_0x56adad(0x1f7)],'background.offsetY':_0x31bdba['background'][_0x56adad(0x1ec)]});const _0x246203=await _0x134bd4[_0x56adad(0x14a)]();_0x134bd4[_0x56adad(0x16a)]({'thumb':_0x246203[_0x56adad(0x139)]},{'diff':![]});if(!game[_0x56adad(0x235)][_0x56adad(0x1e0)]('pdftofoundry',_0x56adad(0x17a)))return;}else _0x1100a2&&_0x20f0af<_0x1100a2[_0x56adad(0x150)]&&(_0x31bdba[_0x56adad(0x1e4)][_0x56adad(0x153)]=_0x134bd4[_0x56adad(0x1e4)][_0x56adad(0x153)],_0x31bdba[_0x56adad(0x209)]=_0x134bd4[_0x56adad(0x209)],_0x31bdba[_0x56adad(0x179)]=_0x134bd4[_0x56adad(0x179)],_0x31bdba[_0x56adad(0x1e4)][_0x56adad(0x1f7)]=_0x134bd4[_0x56adad(0x1e4)][_0x56adad(0x1f7)],_0x31bdba['background'][_0x56adad(0x1ec)]=_0x134bd4[_0x56adad(0x1e4)][_0x56adad(0x1c3)],_0x20f0af=_0x1100a2[_0x56adad(0x150)]);}}const [_0x164bc8]=await Scene[_0x56adad(0x1da)]([_0x31bdba]);_0x31bdba[_0x56adad(0x1fb)]=_0x164bc8['id'];const _0x58f165=[];for(const _0x3d6827 of _0x258240){const _0x5db11d=this['npcActors'][_0x3d6827['id']];if(!_0x5db11d)continue;const _0x35bfaf=await _0x5db11d[_0x56adad(0x20d)]({'x':_0x3d6827['x'],'y':_0x3d6827['y'],'hidden':!![]});_0x58f165[_0x56adad(0x216)](_0x35bfaf[_0x56adad(0x185)]());}_0x164bc8['createEmbeddedDocuments'](_0x56adad(0x220),_0x58f165);const _0x10a183=game[_0x56adad(0x17e)][_0x56adad(0x1e0)](_0x164bc8['id']);if(_0x10a183){const _0x48b4e1=await _0x10a183[_0x56adad(0x14a)]();await _0x10a183[_0x56adad(0x16a)]({'thumb':_0x48b4e1[_0x56adad(0x139)]},{'diff':![]});}}async[_0x1d3e13(0x1b1)](_0x43ed8d,_0x900339){const _0x51ce07=_0x1d3e13,_0x42b216=this['getCanonicalArtForToken'](_0x900339[_0x51ce07(0x1bf)]),_0x52103a=await this[_0x51ce07(0x222)](_0x43ed8d);if(!_0x52103a)return null;_0x52103a['img']=_0x42b216!==void 0x0?_0x42b216[_0x51ce07(0x181)]:_0x900339[_0x51ce07(0x201)],_0x52103a[_0x51ce07(0x15d)][_0x51ce07(0x201)]=_0x42b216!==void 0x0?_0x42b216['token']:_0x900339[_0x51ce07(0x1af)],_0x52103a['folder']=_0x900339[_0x51ce07(0x1a8)];_0x900339['name']&&(_0x52103a['name']=_0x900339[_0x51ce07(0x23c)],_0x52103a[_0x51ce07(0x15d)][_0x51ce07(0x23c)]=_0x900339[_0x51ce07(0x23c)]);_0x900339[_0x51ce07(0x1b7)]&&_0x52103a[_0x51ce07(0x1de)]['traits'][_0x51ce07(0x176)][_0x51ce07(0x216)](_0x51ce07(0x1b7));_0x900339['weak']&&_0x52103a[_0x51ce07(0x1de)][_0x51ce07(0x180)][_0x51ce07(0x176)][_0x51ce07(0x216)](_0x51ce07(0x1b0));_0x52103a['flags'][_0x51ce07(0x15a)]={'module':this['adventure'][_0x51ce07(0x151)],'id':_0x900339['id']};const _0xe57556=game[_0x51ce07(0x235)][_0x51ce07(0x1e0)]('pdftofoundry','alwaysUseImportedIcons');if(game[_0x51ce07(0x223)]['system'][_0x51ce07(0x156)][_0x51ce07(0x1f8)]&&!_0xe57556){const _0xf80744=game[_0x51ce07(0x223)][_0x51ce07(0x1de)][_0x51ce07(0x156)][_0x51ce07(0x1f8)][_0x51ce07(0x1e0)](_0x900339[_0x51ce07(0x1bf)]['uniqueKey']);_0xf80744!==void 0x0&&!_0xf80744['img'][_0x51ce07(0x1b9)]('default-icons')&&Object['assign'](_0x52103a,_0xf80744);}let _0x2bdd0f=null;if(!this[_0x51ce07(0x1ae)][_0x51ce07(0x1b4)]){const _0x1bed11=CONFIG[_0x51ce07(0x22b)][_0x51ce07(0x134)],_0x2a4f29=await _0x1bed11[_0x51ce07(0x217)]([_0x52103a],{'fromCompendium':!![]});_0x2bdd0f=_0x2a4f29[0x0],this[_0x51ce07(0x14f)][_0x900339['id']]=_0x2a4f29[0x0];}return _0x42b216===void 0x0&&_0x54ef6b['setTokenArt'](this[_0x51ce07(0x1ae)],_0x900339,{'actor':_0x900339[_0x51ce07(0x201)],'token':_0x900339[_0x51ce07(0x1af)]}),_0x2bdd0f;}async[_0x1d3e13(0x20f)](_0x2eccb4,_0x3e05f6){const _0xc28d7a=_0x1d3e13;var _0x518f6d,_0x4e50b1;const _0x489277=new _0x12a870(),_0x213e5c=_0x2eccb4[_0xc28d7a(0x13a)][_0xc28d7a(0x13e)](_0x20fc5b=>_0x20fc5b['y']===0x2);if(_0x213e5c===void 0x0)return _0x3e05f6(_0xc28d7a(0x18e),0x1),![];const _0xbd8030=_0x213e5c['text']['match'](/paizo\.com( #([0-9]+))?, (.*?) <(.*?@.*?)>, (.*)/);if(!_0xbd8030)return _0x3e05f6(_0xc28d7a(0x18e),0x1),![];this['adventure'][_0xc28d7a(0x155)]=_0x3e05f6,this['adventure']['preprocess'](_0x2eccb4[_0xc28d7a(0x13a)]),await this['adventure']['extractImageJournals'](_0x2eccb4,_0x489277,this);const _0xb3631e={};for(const [_0x44640d,_0xcd5465]of this['adventure'][_0xc28d7a(0x1b8)][_0xc28d7a(0x1d3)]()){_0x3e05f6(_0xc28d7a(0x20c)+_0x44640d,_0x44640d/this[_0xc28d7a(0x1ae)][_0xc28d7a(0x1b8)][_0xc28d7a(0x17c)]),_0xcd5465(_0x2eccb4,(_0xd6fc82,_0x2cbf94)=>{if(_0xb3631e[_0xd6fc82]===void 0x0)_0xb3631e[_0xd6fc82]=[];_0xb3631e[_0xd6fc82]['push'](_0x2cbf94);});}for(let _0x5616ec in _0xb3631e){const _0x1c0517=this[_0xc28d7a(0x1ae)]['extractDetails'](_0xb3631e[_0x5616ec],_0x489277,_0x5616ec);for(const _0xad5460 of _0x1c0517){_0x489277[_0xc28d7a(0x19b)]['push'](_0xad5460);if(_0x5616ec[_0xc28d7a(0x1f5)](_0xc28d7a(0x1ca)))_0x5616ec=_0xc28d7a(0x212);}}this[_0xc28d7a(0x1ae)][_0xc28d7a(0x1f0)](_0x489277),_0x54ef6b[_0xc28d7a(0x1ee)]();const _0x4a9ff7=__name((_0x530174,_0x19fd7d='m')=>{const _0x1cf29a=_0xc28d7a;let _0x555eba=void 0x0;return async()=>_0x555eba||(_0x555eba=await Folder[_0x1cf29a(0x217)]({'name':this[_0x1cf29a(0x1ae)][_0x1cf29a(0x174)],'type':_0x530174,'parent':null,'sorting':_0x19fd7d}));},_0xc28d7a(0x20b)),_0x19090a=_0x4a9ff7('Scene'),_0x4f88a2=_0x4a9ff7(_0xc28d7a(0x1fd)),_0x4d111f=_0x4a9ff7(_0xc28d7a(0x22b),'a');for(const _0x62dac9 of this[_0xc28d7a(0x1ae)][_0xc28d7a(0x21d)]){this[_0xc28d7a(0x1ae)][_0xc28d7a(0x175)](_0x489277,_0x62dac9['source'],_0x62dac9[_0xc28d7a(0x205)]);}const _0x43721c=new Map();for(const [_0x2d025c,_0x333988]of this['adventure'][_0xc28d7a(0x1d9)][_0xc28d7a(0x1d3)]()){_0x3e05f6(_0xc28d7a(0x18a)+_0x2d025c,_0x2d025c/this[_0xc28d7a(0x1ae)]['npcs'][_0xc28d7a(0x17c)]);const _0x3293e2=await _0x333988[_0xc28d7a(0x1cb)](_0x2eccb4,this);if(_0x3293e2===void 0x0){console['log'](_0xc28d7a(0x17d)+_0x333988['id']);continue;}if(!this[_0xc28d7a(0x1ae)][_0xc28d7a(0x1b4)]);const [_0x2ac876,_0x3f2c6e]=_0x3293e2,_0x7f74dd=await this[_0xc28d7a(0x1b1)](_0x2ac876,{..._0x3f2c6e,'folder':(await _0x4d111f())['id']});if(!_0x7f74dd){_0x7f74dd===void 0x0&&(this[_0xc28d7a(0x1b6)]+=_0xc28d7a(0x1fa)+_0x333988['id']);continue;}for(const _0x28baab of _0x333988[_0xc28d7a(0x186)]??[]){_0x43721c['set'](_0x28baab,_0x7f74dd['id']);}}console[_0xc28d7a(0x187)](JSON['stringify'](_0x43721c,null,0x4));for(const _0x48de01 of _0x489277[_0xc28d7a(0x19b)]){this[_0xc28d7a(0x140)](_0x48de01,_0x43721c);}let _0x5850ae=0x0,_0x44dee6=[..._0x489277[_0xc28d7a(0x19b)]];const _0x3ff15b=[];for(const _0x16c803 of this[_0xc28d7a(0x1ae)][_0xc28d7a(0x1d8)]){const _0x3dec6a=_0x16c803[_0xc28d7a(0x1b8)][_0xc28d7a(0x1f8)](_0x3bc45d=>{const _0x3d4804=_0xc28d7a,_0x595c0b=_0x44dee6[_0x3d4804(0x13e)](_0x2e2684=>_0x2e2684[_0x3d4804(0x211)]['pdftofoundry']['id']===_0x3bc45d['id']);return _0x595c0b!==void 0x0&&_0x3bc45d['name']&&(_0x595c0b[_0x3d4804(0x23c)]=_0x2eccb4[_0x3d4804(0x21e)](_0x3bc45d[_0x3d4804(0x23c)])),_0x595c0b;})[_0xc28d7a(0x1e7)](_0x1a28f7=>_0x1a28f7);_0x44dee6=_0x44dee6[_0xc28d7a(0x1e7)](_0x443979=>!_0x3dec6a[_0xc28d7a(0x1a2)](_0x37961a=>_0x37961a[_0xc28d7a(0x211)][_0xc28d7a(0x15a)]['id']===_0x443979[_0xc28d7a(0x211)][_0xc28d7a(0x15a)]['id'])),_0x3dec6a['length']>0x0&&_0x3ff15b[_0xc28d7a(0x216)]({'name':_0x2eccb4['decodeEncodedString'](_0x16c803[_0xc28d7a(0x23c)]),'pages':_0x3dec6a});}_0x44dee6[_0xc28d7a(0x17c)]>0x0&&_0x3ff15b[_0xc28d7a(0x216)]({'pages':_0x44dee6,'name':this['adventure']['fullName']});for(const {pages:_0x3ec731,name:_0x200540}of _0x3ff15b){_0x5850ae+=0x64;const _0x37185f={'name':_0x200540,'folder':(await _0x4f88a2())['id'],'sort':_0x5850ae,'permission':{'default':0x0},'pages':_0x3ec731[_0xc28d7a(0x1f8)](_0x12462d=>({..._0x12462d}))},_0x33a9ea=await JournalEntry[_0xc28d7a(0x1da)]([_0x37185f]);for(let _0x3697e5=0x0;_0x3697e5<_0x3ec731[_0xc28d7a(0x17c)];_0x3697e5++){_0x3ec731[_0x3697e5][_0xc28d7a(0x152)]=_0x33a9ea[0x0]['id'],_0x3ec731[_0x3697e5][_0xc28d7a(0x154)]=_0x33a9ea[0x0][_0xc28d7a(0x1b8)][_0xc28d7a(0x18f)][_0x3697e5]['id'];}}let _0x87df7c=0x0;for(const [_0x198d91,_0x28e730]of this['adventure']['scenes'][_0xc28d7a(0x1d3)]()){_0x3e05f6(_0xc28d7a(0x221)+_0x198d91,_0x198d91/this[_0xc28d7a(0x1ae)]['scenes'][_0xc28d7a(0x17c)]);const _0x7642d8=await _0x28e730[_0xc28d7a(0x1cb)](_0x2eccb4,_0x489277,this);if(_0x7642d8===void 0x0)continue;_0x87df7c+=0x64,this[_0xc28d7a(0x20a)]({..._0x7642d8,'sort':_0x87df7c,'folder':(await _0x19090a())['id']},(_0x518f6d=_0x28e730[_0xc28d7a(0x1f2)])==null?void 0x0:_0x518f6d[_0xc28d7a(0x23c)],(_0x4e50b1=_0x28e730[_0xc28d7a(0x1f2)])==null?void 0x0:_0x4e50b1['priority'],_0x28e730[_0xc28d7a(0x1dd)]);}return this['finalize'](),_0x3e05f6('Complete.\x20Enjoy!',0x1),!![];}};__name(_ModuleImporter,_0x1d3e13(0x1d4));let ModuleImporter=_ModuleImporter;_0x26cbd0[_0x1d3e13(0x188)][_0x1d3e13(0x21b)]=_0x37056b;const readUploadedFileAsBinary=__name(_0x1a31e5=>{const _0x385de7=new FileReader();return new Promise((_0x42c200,_0x5a1c93)=>{const _0x3f28cd=_0x924f;_0x385de7[_0x3f28cd(0x15b)]=()=>{const _0x39d2b1=_0x3f28cd;_0x385de7['abort'](),_0x5a1c93(new DOMException(_0x39d2b1(0x190)));},_0x385de7[_0x3f28cd(0x1ad)]=()=>{_0x42c200(_0x385de7['result']);},_0x385de7[_0x3f28cd(0x239)](_0x1a31e5);});},_0x1d3e13(0x22f)),readUploadedFileAsText=__name(_0x40e06a=>{const _0x4a9f21=new FileReader();return new Promise((_0x4c192a,_0x291950)=>{const _0x492592=_0x924f;_0x4a9f21['onerror']=()=>{const _0x30c318=_0x924f;_0x4a9f21[_0x30c318(0x1c1)](),_0x291950(new DOMException('Problem\x20parsing\x20input\x20file.'));},_0x4a9f21[_0x492592(0x1ad)]=()=>{const _0x112f45=_0x492592;_0x4c192a(_0x4a9f21[_0x112f45(0x14c)]);},_0x4a9f21[_0x492592(0x1cd)](_0x40e06a);});},_0x1d3e13(0x1b3));function progressFn(_0x3e3e65,_0x56899a){const _0x2b4b7a=_0x1d3e13,_0x1ffd75=document[_0x2b4b7a(0x13c)](_0x2b4b7a(0x1a7)),_0x2eac66=Math[_0x2b4b7a(0x147)](0x64*_0x56899a,0x0,0x64);_0x1ffd75[_0x2b4b7a(0x168)]('#context')[_0x2b4b7a(0x1c0)]=_0x3e3e65,_0x1ffd75[_0x2b4b7a(0x168)]('#loading-bar')[_0x2b4b7a(0x183)][_0x2b4b7a(0x209)]=_0x2eac66+'%',_0x1ffd75[_0x2b4b7a(0x168)](_0x2b4b7a(0x207))[_0x2b4b7a(0x1c0)]='',_0x1ffd75[_0x2b4b7a(0x183)][_0x2b4b7a(0x1d6)]='block';if(_0x56899a===0x1&&!_0x1ffd75[_0x2b4b7a(0x164)])$(_0x1ffd75)[_0x2b4b7a(0x1bd)](0x1388);}__name(progressFn,_0x1d3e13(0x155));async function generateData(_0x8ed786){const _0x30d350=_0x1d3e13;let _0x34e886;if(_0x8ed786['type']==='application/json'){const _0x3aeac4=await readUploadedFileAsText(_0x8ed786);_0x34e886={'textDetails':JSON[_0x30d350(0x231)](_0x3aeac4),'imageDetails':[]};}else{const _0x168188=await readUploadedFileAsBinary(_0x8ed786),_0x1d8c81=new Uint8Array(_0x168188);_0x34e886=await parsePdf(_0x1d8c81,progressFn,void 0x0);}const _0x307b98=_0x7cba08(_0x34e886);if(_0x307b98===void 0x0){progressFn('failed\x20to\x20detect\x20pdf.\x20cannot\x20proceed\x20:(',0x0);return;}const _0x50bd82=new ModuleImporter(_0x307b98);await _0x50bd82[_0x30d350(0x20f)](_0x34e886,progressFn);const _0x1a6521={'whisper':[game[_0x30d350(0x224)]],'content':_0x30d350(0x18d)+_0x307b98[_0x30d350(0x174)]+'\x20is\x20complete'+_0x50bd82[_0x30d350(0x1b6)],'type':0x0,'blind':!![],'speaker':{'alias':_0x30d350(0x141)}};ChatMessage['create'](_0x1a6521,{});}__name(generateData,_0x1d3e13(0x16d));export{generateData};
